<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panel - Karate Academy</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="stylesheet" href="admin.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <!-- Admin Panel -->
    <div id="adminPanel" class="admin-container">
        <!-- Admin Navigation -->
        <nav class="admin-nav">
            <div class="admin-brand">
                <img id="adminNavLogoImage" src="" alt="Logo" style="display: none;">
                <i class="fas fa-fist-raised"></i>
                <span>Admin Panel</span>
            </div>
            <div class="admin-user">
                <span><i class="fas fa-user-shield"></i> Administrator</span>
                <button onclick="logout()" class="btn btn-outline btn-sm">Logout</button>
            </div>
        </nav>

        <!-- Admin Content -->
        <div class="admin-content">
            <!-- Admin Tabs -->
            <div class="admin-tabs">
                <button class="admin-tab active" onclick="showAdminSection('videos')">
                    <i class="fas fa-video"></i> Videos
                </button>
                <button class="admin-tab" onclick="showAdminSection('members')">
                    <i class="fas fa-users"></i> Members
                </button>
                <button class="admin-tab" onclick="showAdminSection('masters')">
                    <i class="fas fa-user-tie"></i> Masters
                </button>
                <button class="admin-tab" onclick="showAdminSection('champions')">
                    <i class="fas fa-trophy"></i> Champions
                </button>
                <button class="admin-tab" onclick="showAdminSection('awarded')">
                    <i class="fas fa-certificate"></i> Awarded
                </button>
                <button class="admin-tab" onclick="showAdminSection('settings')">
                    <i class="fas fa-cog"></i> Settings
                </button>
                <button class="admin-tab" onclick="showAdminSection('pricing')">
                    <i class="fas fa-dollar-sign"></i> Pricing
                </button>
                <button class="admin-tab" onclick="showAdminSection('payment')">
                    <i class="fas fa-credit-card"></i> Payment Sessions
                </button>
                <button class="admin-tab" onclick="window.location.href='image-gallery.html'">
                    <i class="fas fa-images"></i> Images
                </button>
                <button class="admin-tab" onclick="window.location.href='video-gallery.html'">
                    <i class="fas fa-video"></i> Videos
                </button>
            </div>

            <!-- Videos Section -->
            <div id="adminVideos" class="admin-section">
                <div class="admin-header">
                    <h2>Video Management</h2>
                    <button onclick="showAddVideoModal()" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add New Video
                    </button>
                </div>

                <!-- Statistics -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-video"></i>
                        <div class="stat-info">
                            <span class="stat-number" id="totalVideos">0</span>
                            <span class="stat-label">Total Videos</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-unlock"></i>
                        <div class="stat-info">
                            <span class="stat-number" id="freeVideos">0</span>
                            <span class="stat-label">Free Videos</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-lock"></i>
                        <div class="stat-info">
                            <span class="stat-number" id="lockedVideos">0</span>
                            <span class="stat-label">Locked Videos</span>
                        </div>
                    </div>
                </div>

                <!-- Video List -->
                <div class="video-management">
                    <h3>All Videos</h3>
                    <div class="filter-tabs">
                        <button class="filter-tab active" onclick="filterVideos('all')">All</button>
                        <button class="filter-tab" onclick="filterVideos('kata')">Kata</button>
                        <button class="filter-tab" onclick="filterVideos('beginner')">Beginner</button>
                        <button class="filter-tab" onclick="filterVideos('kumite')">Kumite</button>
                    </div>
                    <div id="videoList" class="video-list">
                        <!-- Videos will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Members Section -->
            <div id="adminMembers" class="admin-section" style="display: none;">
                <div class="admin-header">
                    <h2>Member Management</h2>
                    <button onclick="showAddMemberModal()" class="btn btn-primary">
                        <i class="fas fa-user-plus"></i> Add New Member
                    </button>
                </div>

                <!-- Member Stats -->
                <div class="stats-grid">
                    <div class="stat-card">
                        <i class="fas fa-users"></i>
                        <div class="stat-info">
                            <span class="stat-number" id="totalMembers">0</span>
                            <span class="stat-label">Total Members</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-star"></i>
                        <div class="stat-info">
                            <span class="stat-number" id="beginnerMembers">0</span>
                            <span class="stat-label">Beginner</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-crown"></i>
                        <div class="stat-info">
                            <span class="stat-number" id="advancedMembers">0</span>
                            <span class="stat-label">Advanced</span>
                        </div>
                    </div>
                    <div class="stat-card">
                        <i class="fas fa-dragon"></i>
                        <div class="stat-info">
                            <span class="stat-number" id="eliteMembers">0</span>
                            <span class="stat-label">Elite</span>
                        </div>
                    </div>
                </div>

                <!-- Members List -->
                <div class="video-management">
                    <h3>All Members</h3>
                    <div class="filter-tabs">
                        <button class="filter-tab active" onclick="filterMembers('all')">All</button>
                        <button class="filter-tab" onclick="filterMembers('beginner')">Beginner</button>
                        <button class="filter-tab" onclick="filterMembers('advanced')">Advanced</button>
                        <button class="filter-tab" onclick="filterMembers('elite')">Elite</button>
                    </div>
                    <div id="membersList" class="video-list">
                        <!-- Members will be loaded here -->
                    </div>
                </div>
            </div>

            <!-- Masters Section -->
            <div id="adminMasters" class="admin-section" style="display: none;">
                <div class="admin-header">
                    <h2>Masters Gallery Management</h2>
                    <button onclick="showAddGalleryModal('masters')" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add New Master
                    </button>
                </div>
                <div id="mastersList" class="video-list">
                    <!-- Masters will be loaded here -->
                </div>
            </div>

            <!-- Champions Section -->
            <div id="adminChampions" class="admin-section" style="display: none;">
                <div class="admin-header">
                    <h2>Champions Gallery Management</h2>
                    <button onclick="showAddGalleryModal('champions')" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add New Champion
                    </button>
                </div>
                <div id="championsList" class="video-list">
                    <!-- Champions will be loaded here -->
                </div>
            </div>

            <!-- Awarded Section -->
            <div id="adminAwarded" class="admin-section" style="display: none;">
                <div class="admin-header">
                    <h2>Awards Gallery Management</h2>
                    <button onclick="showAddGalleryModal('awarded')" class="btn btn-primary">
                        <i class="fas fa-plus"></i> Add New Award
                    </button>
                </div>
                <div id="awardedList" class="video-list">
                    <!-- Awards will be loaded here -->
                </div>
            </div>

            <!-- Settings Section -->
            <div id="adminSettings" class="admin-section" style="display: none;">
                <div class="admin-header">
                    <h2>Site Settings</h2>
                </div>
                
                <div class="settings-container">
                    <!-- Logo Settings -->
                    <div class="settings-card">
                        <h3><i class="fas fa-image"></i> Site Logo</h3>
                        <form id="logoForm">
                            <div class="form-group">
                                <label for="siteName">Site Name</label>
                                <input type="text" id="siteName" placeholder="Karate Academy">
                            </div>
                            <div class="form-group">
                                <label for="logoImage">Logo Image</label>
                                <input type="file" id="logoImage" accept="image/*" title="Select logo image file" onchange="previewLogoImage(this)">
                                <button type="button" class="btn btn-outline btn-sm" onclick="window.location.href='image-gallery.html?for=logo'" style="margin-top: 0.5rem;">
                                    <i class="fas fa-images"></i> Choose from Gallery
                                </button>
                                <div id="logoImagePreview" class="image-preview"></div>
                            </div>
                            <div class="form-group">
                                <label for="logoIcon">Logo Icon Class</label>
                                <input type="text" id="logoIcon" placeholder="fas fa-fist-raised">
                                <small>Font Awesome icon class (e.g., fas fa-fist-raised, fas fa-dragon, fas fa-star)</small>
                            </div>
                            <button type="submit" class="btn btn-primary">Save Logo Settings</button>
                        </form>
                    </div>
                    
                    <!-- Contact Settings -->
                    <div class="settings-card">
                        <h3><i class="fas fa-address-card"></i> Contact Information</h3>
                        <form id="contactForm">
                            <div class="form-group">
                                <label for="contactAddress">Address</label>
                                <input type="text" id="contactAddress" placeholder="123 Karate Street, Martial Arts City">
                            </div>
                            <div class="form-row">
                                <div class="form-group">
                                    <label for="contactPhone">Phone</label>
                                    <input type="tel" id="contactPhone" placeholder="(555) 123-4567">
                                </div>
                                <div class="form-group">
                                    <label for="contactEmail">Email</label>
                                    <input type="email" id="contactEmail" placeholder="info@karateacademy.com">
                                </div>
                            </div>
                            <div class="form-group">
                                <label for="contactHours">Business Hours</label>
                                <input type="text" id="contactHours" placeholder="Mon-Sat: 6AM - 9PM">
                            </div>
                            <button type="submit" class="btn btn-primary">Save Contact Settings</button>
                        </form>
                    </div>
                </div>
            </div>

            <!-- Pricing Section -->
            <div id="adminPricing" class="admin-section" style="display: none;">
                <div class="admin-header">
                    <h2>Membership Plans</h2>
                </div>
                
                <div class="pricing-container">
                    <form id="pricingForm">
                        <div class="pricing-grid">
                            <!-- Beginner Plan -->
                            <div class="pricing-card">
                                <h3><i class="fas fa-star"></i> Beginner Plan</h3>
                                <div class="form-group">
                                    <label for="beginnerPrice">Price (₹/month)</label>
                                    <input type="number" id="beginnerPrice" min="0" value="49">
                                </div>
                                <div class="form-group">
                                    <label for="beginnerDiscount">Discount (%)</label>
                                    <input type="number" id="beginnerDiscount" min="0" max="100" value="0">
                                </div>
                                <div class="form-group">
                                    <label>Features</label>
                                    <div class="features-list" id="beginnerFeaturesList">
                                        <!-- Features will be loaded dynamically -->
                                    </div>
                                    <div class="add-feature-row">
                                        <input type="text" id="beginnerNewFeature" placeholder="Add new feature">
                                        <button type="button" class="btn btn-small" onclick="addFeature('beginner')"><i class="fas fa-plus"></i> Add</button>
                                    </div>
                                </div>
                                <div class="price-preview">
                                    <span class="original-price">₹<span id="beginnerOriginal">49</span></span>
                                    <span class="final-price">₹<span id="beginnerFinal">49</span>/month</span>
                                </div>
                            </div>
                            
                            <!-- Advanced Plan -->
                            <div class="pricing-card featured">
                                <h3><i class="fas fa-crown"></i> Advanced Plan</h3>
                                <div class="form-group">
                                    <label for="advancedPrice">Price (₹/month)</label>
                                    <input type="number" id="advancedPrice" min="0" value="89">
                                </div>
                                <div class="form-group">
                                    <label for="advancedDiscount">Discount (%)</label>
                                    <input type="number" id="advancedDiscount" min="0" max="100" value="0">
                                </div>
                                <div class="form-group">
                                    <label>Features</label>
                                    <div class="features-list" id="advancedFeaturesList">
                                        <!-- Features will be loaded dynamically -->
                                    </div>
                                    <div class="add-feature-row">
                                        <input type="text" id="advancedNewFeature" placeholder="Add new feature">
                                        <button type="button" class="btn btn-small" onclick="addFeature('advanced')"><i class="fas fa-plus"></i> Add</button>
                                    </div>
                                </div>
                                <div class="price-preview">
                                    <span class="original-price">₹<span id="advancedOriginal">89</span></span>
                                    <span class="final-price">₹<span id="advancedFinal">89</span>/month</span>
                                </div>
                            </div>
                            
                            <!-- Elite Plan -->
                            <div class="pricing-card">
                                <h3><i class="fas fa-dragon"></i> Elite Plan</h3>
                                <div class="form-group">
                                    <label for="elitePrice">Price (₹/month)</label>
                                    <input type="number" id="elitePrice" min="0" value="149">
                                </div>
                                <div class="form-group">
                                    <label for="eliteDiscount">Discount (%)</label>
                                    <input type="number" id="eliteDiscount" min="0" max="100" value="0">
                                </div>
                                <div class="form-group">
                                    <label>Features</label>
                                    <div class="features-list" id="eliteFeaturesList">
                                        <!-- Features will be loaded dynamically -->
                                    </div>
                                    <div class="add-feature-row">
                                        <input type="text" id="eliteNewFeature" placeholder="Add new feature">
                                        <button type="button" class="btn btn-small" onclick="addFeature('elite')"><i class="fas fa-plus"></i> Add</button>
                                    </div>
                                </div>
                                <div class="price-preview">
                                    <span class="original-price">₹<span id="eliteOriginal">149</span></span>
                                    <span class="final-price">₹<span id="eliteFinal">149</span>/month</span>
                                </div>
                            </div>
                        </div>
                        <button type="submit" class="btn btn-primary btn-save-pricing">Save Pricing Settings</button>
                    </form>
                </div>
            </div>

            <!-- Payment Sessions Section -->
            <div id="adminPayment" class="admin-section" style="display: none;">
                <div class="admin-header">
                    <h2>Payment Sessions</h2>
                    <p>Control which payment methods are available for users</p>
                </div>
                
                <div class="payment-sessions-container">
                    <div class="payment-session-card">
                        <div class="payment-session-header">
                            <div class="payment-session-icon upi">
                                <i class="fas fa-mobile-alt"></i>
                            </div>
                            <div class="payment-session-info">
                                <h3>UPI Payment</h3>
                                <p>Allow users to pay using Google Pay, PhonePe, Paytm or any UPI app</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggleUpi" onchange="togglePaymentSession('upi')">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="payment-session-card">
                        <div class="payment-session-header">
                            <div class="payment-session-icon banking">
                                <i class="fas fa-university"></i>
                            </div>
                            <div class="payment-session-info">
                                <h3>Net Banking</h3>
                                <p>Allow users to pay via direct bank transfer</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggleBanking" onchange="togglePaymentSession('banking')">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="payment-session-card">
                        <div class="payment-session-header">
                            <div class="payment-session-icon check">
                                <i class="fas fa-money-check"></i>
                            </div>
                            <div class="payment-session-info">
                                <h3>Pay by Check</h3>
                                <p>Allow users to pay at the academy reception via check</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggleCheck" onchange="togglePaymentSession('check')">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="payment-session-card">
                        <div class="payment-session-header">
                            <div class="payment-session-icon screenshot" style="background: linear-gradient(135deg, #27ae60, #2ecc71);">
                                <i class="fas fa-camera"></i>
                            </div>
                            <div class="payment-session-info">
                                <h3>Upload Screenshot</h3>
                                <p>Allow users to upload payment screenshot from gallery</p>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" id="toggleScreenshot" onchange="togglePaymentSession('screenshot')">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <div class="payment-session-status" id="paymentStatusMessage">
                        <i class="fas fa-info-circle"></i>
                        <span>All payment methods are enabled by default. Toggle above to disable specific payment options.</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Add/Edit Video Modal -->
    <div id="videoModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close-modal" onclick="closeVideoModal()">&times;</span>
            <h3 id="modalTitle">Add New Video</h3>
            <form id="videoForm">
                <input type="hidden" id="editVideoId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="videoTitle">Video Title</label>
                        <input type="text" id="videoTitle" placeholder="e.g., Shotokan Kata - Taikyoku Shodan" required>
                    </div>
                    <div class="form-group">
                        <label for="videoCategory">Category</label>
                        <select id="videoCategory" required>
                            <option value="kata">Kata</option>
                            <option value="beginner">Beginner Basics</option>
                            <option value="kumite">Kumite</option>
                        </select>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="videoDuration">Duration</label>
                        <input type="text" id="videoDuration" placeholder="e.g., 3:45" required>
                    </div>
                    <div class="form-group">
                        <label for="videoLevel">Skill Level</label>
                        <select id="videoLevel" required>
                            <option value="free">Free Preview</option>
                            <option value="locked">Members Only</option>
                        </select>
                    </div>
                </div>
                <div class="form-group">
                    <label for="videoDescription">Description</label>
                    <textarea id="videoDescription" rows="3" placeholder="Brief description of the video"></textarea>
                </div>
                <div class="form-group">
                    <label for="videoThumbnail">Thumbnail Image</label>
                    <input type="file" id="videoThumbnail" accept="image/*" title="Select video thumbnail image" onchange="previewVideoThumbnail(this)">
                    <button type="button" class="btn btn-outline btn-sm" onclick="window.location.href='video-gallery.html'" style="margin-top: 0.5rem;">
                        <i class="fas fa-video"></i> Choose Video from Gallery
                    </button>
                    <div id="videoThumbnailPreview" class="image-preview"></div>
                </div>
                <div class="form-actions">
                    <button type="button" onclick="closeVideoModal()" class="btn btn-outline">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Video</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add/Edit Gallery Modal -->
    <div id="galleryModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close-modal" onclick="closeGalleryModal()">&times;</span>
            <h3 id="galleryModalTitle">Add New Entry</h3>
            <form id="galleryForm">
                <input type="hidden" id="editGalleryId">
                <input type="hidden" id="galleryType">
                <div class="form-group">
                    <label for="galleryName">Name/Title</label>
                    <input type="text" id="galleryName" placeholder="e.g., Sensei John Smith" required>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="gallerySubtitle">Subtitle/Title</label>
                        <input type="text" id="gallerySubtitle" placeholder="e.g., 8th Dan Black Belt" required>
                    </div>
                    <div class="form-group">
                        <label for="galleryTag">Tag/Role</label>
                        <input type="text" id="galleryTag" placeholder="e.g., Head Instructor">
                    </div>
                </div>
                <div class="form-group">
                    <label for="galleryImage">Image</label>
                    <input type="file" id="galleryImage" accept="image/*" title="Select gallery image file" onchange="previewGalleryImage(this)">
                    <button type="button" class="btn btn-outline btn-sm" onclick="window.location.href='image-gallery.html'" style="margin-top: 0.5rem;">
                        <i class="fas fa-images"></i> Choose from Gallery
                    </button>
                    <div id="galleryImagePreview" class="image-preview"></div>
                </div>
                <div class="form-actions">
                    <button type="button" onclick="closeGalleryModal()" class="btn btn-outline">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Add Member Modal -->
    <div id="memberModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close-modal" onclick="closeMemberModal()">&times;</span>
            <h3 id="memberModalTitle">Add New Member</h3>
            <form id="memberForm">
                <input type="hidden" id="editMemberId">
                <div class="form-row">
                    <div class="form-group">
                        <label for="memberName">Full Name</label>
                        <input type="text" id="memberName" placeholder="Enter full name" required>
                    </div>
                    <div class="form-group">
                        <label for="memberEmail">Email</label>
                        <input type="email" id="memberEmail" placeholder="Enter email" required>
                    </div>
                </div>
                <div class="form-row">
                    <div class="form-group">
                        <label for="memberPhone">Phone</label>
                        <input type="tel" id="memberPhone" placeholder="Enter phone number">
                    </div>
                    <div class="form-group">
                        <label for="memberPlan">Membership Plan</label>
                        <select id="memberPlan" required>
                            <option value="beginner">Beginner - ₹49/month</option>
                            <option value="advanced">Advanced - ₹89/month</option>
                            <option value="elite">Elite - ₹149/month</option>
                        </select>
                    </div>
                </div>
                <div class="form-actions">
                    <button type="button" onclick="closeMemberModal()" class="btn btn-outline">Cancel</button>
                    <button type="submit" class="btn btn-primary">Save Member</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Upgrade Member Modal -->
    <div id="upgradeModal" class="modal">
        <div class="modal-content modal-small">
            <span class="close-modal" onclick="closeUpgradeModal()">&times;</span>
            <h3>Upgrade Membership</h3>
            <p id="upgradeMemberName"></p>
            <form id="upgradeForm">
                <input type="hidden" id="upgradeMemberId">
                <div class="form-group">
                    <label for="newPlan">Select New Plan</label>
                    <select id="newPlan" required>
                        <option value="beginner">Beginner - ₹49/month</option>
                        <option value="advanced">Advanced - ₹89/month</option>
                        <option value="elite">Elite - ₹149/month</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="button" onclick="closeUpgradeModal()" class="btn btn-outline">Cancel</button>
                    <button type="submit" class="btn btn-primary">Upgrade</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Delete Confirmation Modal -->
    <div id="deleteModal" class="modal">
        <div class="modal-content modal-small">
            <h3>Confirm Delete</h3>
            <p>Are you sure you want to delete this item?</p>
            <input type="hidden" id="deleteGalleryId">
            <input type="hidden" id="deleteGalleryType">
            <div class="form-actions">
                <button onclick="closeDeleteModal()" class="btn btn-outline">Cancel</button>
                <button onclick="confirmDelete()" class="btn btn-primary" style="background-color: #e74c3c;">Delete</button>
            </div>
        </div>
    </div>

    <!-- Image Gallery Modal -->
    <div id="imageGalleryModal" class="modal">
        <div class="modal-content modal-large">
            <span class="close-modal" onclick="closeImageGalleryModal()">&times;</span>
            <h3><i class="fas fa-images"></i> Select Image from Gallery</h3>
            <p>Click on an image to select it</p>
            <div id="imageGalleryGrid" class="image-gallery-grid">
                <!-- Images will be loaded here -->
            </div>
        </div>
    </div>

    <script src="firebase-config.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>
    <script src="admin.js"></script>
</body>
</html>
